create database FACTURACION2025;
GO
USE FACTURACION2025;
GO

SET DATEFORMAT dmy;
GO

CREATE TABLE CLIENTE
(NROCLI     INTEGER     NOT NULL,
 NYAPE      VARCHAR(20) NOT NULL,
 DOMICILIO  VARCHAR(30),
 LOCALIDAD  VARCHAR(20),
 SALDOCLI   DECIMAL(9,2) DEFAULT 0
 PRIMARY KEY (NROCLI));

CREATE TABLE RUBRO
(COD_RUBRO        INTEGER,
 DESCRIPCION      VARCHAR(30)
 PRIMARY KEY (COD_RUBRO) );

CREATE TABLE ARTICULO
(NROARTIC         INTEGER NOT NULL,
 DESCRIPCION      VARCHAR(30) NOT NULL,
 RUBRO            INTEGER,
 STOCK            INTEGER NOT NULL DEFAULT 0 ,
 PTO_REPOSICION   INTEGER NOT NULL DEFAULT 0 ,
 PRECIO           DECIMAL(8,2) 
 PRIMARY KEY (NROARTIC)
 FOREIGN KEY (RUBRO) REFERENCES RUBRO(COD_RUBRO));

CREATE TABLE FACTURA
(NROFACTURA  INTEGER NOT NULL,
 CLIENTE     INTEGER ,
 FECHA       DATE NOT NULL DEFAULT GETDATE(),
 TOTAL       DECIMAL(8,2) NOT NULL DEFAULT 0
 PRIMARY KEY (NROFACTURA)
 FOREIGN KEY (CLIENTE) REFERENCES CLIENTE(NROCLI)
 ON DELETE NO ACTION
 ON UPDATE CASCADE);

--
-- PRECIOUNI SIN "NOT NULL" Y SIN DEFAULT... SINO PROBLEMAS EN UPDATE


CREATE TABLE DETALLE
(NROFACTURA  INTEGER NOT NULL CHECK(NROFACTURA > 0),
 RENGLON     CHAR(3) NOT NULL,
 ARTICULO    INTEGER NOT NULL,
 CANTIDAD    INTEGER NOT NULL,
 PRECIOUNI   DECIMAL(8,2) 
 PRIMARY KEY (NROFACTURA, RENGLON)
--CONSTRAINT ck_1    CHECK (CANTIDAD > 0 AND PRECIOUNI >= 0)
CONSTRAINT fk_fact FOREIGN KEY (NROFACTURA) REFERENCES FACTURA(NROFACTURA) 
ON DELETE CASCADE);

--
-- INSERT INTO de Datos
--
BEGIN TRANSACTION;
INSERT INTO CLIENTE VALUES (60,'Karina González','Pavón 1955','Capital Federal',0.00);
INSERT INTO CLIENTE VALUES (69,'Juan Martinez','Maipu 123','Capital Federal',-2800.00);
INSERT INTO CLIENTE VALUES (109,'Pedro Garcia','Rosales 346','Capital Federal',-12100.00);
INSERT INTO CLIENTE VALUES (138,'Isela Perez','Alsina 399','Carapachay',-39009.67);
INSERT INTO CLIENTE VALUES (160,'Silvana Zabala','Medrano 32','Capital Federal',-4507.67);
INSERT INTO CLIENTE VALUES (179,'Natalia Lopéz','Chacabuco 476','Morón',5764.67);
INSERT INTO CLIENTE VALUES (180,'Miryam Benitez','Av. Independencia 742','Capital Federal',3000.00);
INSERT INTO CLIENTE VALUES (194,'Patricio Blanco','Belgrano 22','Capital Federal',22132.00);
INSERT INTO CLIENTE VALUES (207,'Cecilia Nieto','Av. Rivadavia 13520','Carapachay',-5348.67);
INSERT INTO CLIENTE VALUES (219,'Karina Pierro','Av. De Mayo 11','Capital Federal',-17631.00);
INSERT INTO CLIENTE VALUES (230,'Lautaro Gonzalez','Alvarado 793','Morón',9294.67);
INSERT INTO CLIENTE VALUES (239,'Julio Gomez','Quintana 522','Capital Federal',7579.67);
INSERT INTO CLIENTE VALUES (248,'Fernando Pereira','Fuertes 88','Capital Federal',6324.33);
INSERT INTO CLIENTE VALUES (256,'Claudio Ramirez','Laprida 397','Carapachay',-1168.33);
INSERT INTO CLIENTE VALUES (263,'Diego Díaz','Juncal 77','Capital Federal',2881.33);
INSERT INTO CLIENTE VALUES (270,'Maria Dominguez','Moreno 435','Morón',-6880.00);
INSERT INTO CLIENTE VALUES (277,'Florencia Sastre','Alvear 32','Capital Federal',-945.00);
INSERT INTO CLIENTE VALUES (283,'Victoria Colombres','Alsina 1123','Carapachay',-8587.67);
INSERT INTO CLIENTE VALUES (285,'Juan Pablo Venitez','Moreno 741','Capital Federal',-12800.00);
INSERT INTO CLIENTE VALUES (289,'Carlos Alvarez','Belgrano 632','Capital Federal',-1176.67);
INSERT INTO CLIENTE VALUES (294,'Antonio Fernandez','Corrientes 480','Capital Federal',-96128.33);
INSERT INTO CLIENTE VALUES (299,'Belen Silva','Cordoba 56','Morón',-9756.67);
INSERT INTO CLIENTE VALUES (300,'Matias Fuentes','Mitre 134','Capital Federal',-4777.00);
INSERT INTO CLIENTE VALUES (301,'Carlos Andrés Rosas','Mitre 134','Capital Federal',0.00);
INSERT INTO CLIENTE VALUES (302,'Mercedes Fuentes','Rosario 571','Capital Federal',0.00);
COMMIT;	

BEGIN TRANSACTION;
INSERT INTO RUBRO VALUES (1,'herramientas Manuales');
INSERT INTO RUBRO VALUES (2,'tornillos');
INSERT INTO RUBRO VALUES (3,'clavo');
INSERT INTO RUBRO VALUES (4,'herramientas Electricas');
INSERT INTO RUBRO VALUES (5,'articulos de Electricidad');
INSERT INTO RUBRO VALUES (6,'electrodomésticos');
COMMIT;

BEGIN TRANSACTION;
INSERT INTO ARTICULO VALUES ('4000','Destornillador',1,855,111,800.00);
INSERT INTO ARTICULO VALUES ('4010','Pinza',1,878,222,1700.00);
INSERT INTO ARTICULO VALUES ('4020','Tenaza',1,234,333,1800.00);
INSERT INTO ARTICULO VALUES ('4030','Martillo',1,253,44,2400.00);
INSERT INTO ARTICULO VALUES ('4040','Moladora',4,123,555,13000.00);
INSERT INTO ARTICULO VALUES ('4050','Clavo en L',3,317,666,50.00);
INSERT INTO ARTICULO VALUES ('4060','Tuerca',2,45,777,37.00);
INSERT INTO ARTICULO VALUES ('4070','Tornillo',2,200,88,10.00);
INSERT INTO ARTICULO VALUES ('4080','Soldador',4,623,999,9000.00);
INSERT INTO ARTICULO VALUES ('4090','Enchufe',5,960,123,400.00);
INSERT INTO ARTICULO VALUES ('4100','Cable',5,458,456,78.00);
INSERT INTO ARTICULO VALUES ('4110','Clavo punta París',3,30,78,50.00);


--insert  artículos del rubro Electrodomésticos
INSERT INTO ARTICULO (NROARTIC, DESCRIPCION, rubro, STOCK,  PRECIO) 
VALUES ('4120','plancha',6,10,2500.00);

INSERT INTO ARTICULO (NROARTIC, DESCRIPCION, rubro, STOCK, PRECIO )
VALUES ('4130','aspiradora',6,5, 25000);



--  insertar un artículo sin rubro, punto de reposición  ni precio
INSERT INTO ARTICULO (NROARTIC, DESCRIPCION, stock ) 
VALUES ('4140','pila recargable  aaa',100);


COMMIT;

BEGIN TRANSACTION;
INSERT INTO FACTURA VALUES (1001,69,'2/2/2019',0.00);
INSERT INTO FACTURA VALUES (1002,109,'2/2/2019',0.00);
INSERT INTO FACTURA VALUES (1003,138,'4/2/2019',0.00);
INSERT INTO FACTURA VALUES (1004,160,'4/2/2019',0.00);
INSERT INTO FACTURA VALUES (1005,179,'6/2/2019',0.00);
INSERT INTO FACTURA VALUES (1006,194,'6/2/2019',0.00);
INSERT INTO FACTURA VALUES (1007,207,'8/2/2019',0.00);
INSERT INTO FACTURA VALUES (1008,219,'8/2/2019',0.00);
INSERT INTO FACTURA VALUES (1009,230,'10/2/2019',0.00);
INSERT INTO FACTURA VALUES (1010,239,'10/2/2019',0.00);
INSERT INTO FACTURA VALUES (1011,248,'12/3/2019',0.00);
INSERT INTO FACTURA VALUES (1012,256,'12/3/2019',0.00);
INSERT INTO FACTURA VALUES (1013,263,'14/3/2019',0.00);
INSERT INTO FACTURA VALUES (1014,109,'14/3/2019',0.00);
INSERT INTO FACTURA VALUES (1015,277,'15/3/2019',0.00);
INSERT INTO FACTURA VALUES (1016,283,'15/3/2019',0.00);
INSERT INTO FACTURA VALUES (1017,109,'17/3/2019',0.00);
INSERT INTO FACTURA VALUES (1018,294,'17/3/2019',0.00);
INSERT INTO FACTURA VALUES (1019,299,'19/3/2019',0.00);
INSERT INTO FACTURA VALUES (1020,69,'19/3/2019',0.00);
INSERT INTO FACTURA VALUES (1021,109,'7/4/2019',0.00);
INSERT INTO FACTURA VALUES (1022,160,'7/4/2019',0.00);
INSERT INTO FACTURA VALUES (1023,256,'9/4/2019',0.00);
INSERT INTO FACTURA VALUES (1024,239,'9/4/2019',0.00);
INSERT INTO FACTURA VALUES (1025,138,'11/4/2019',0.00);
INSERT INTO FACTURA VALUES (1026,239,'11/4/2019',0.00);
INSERT INTO FACTURA VALUES (1027,138,'13/4/2019',0.00);
INSERT INTO FACTURA VALUES (1028,160,'13/4/2019',0.00);
INSERT INTO FACTURA VALUES (1029,230,'15/4/2019',0.00);
INSERT INTO FACTURA VALUES (1030,109,'15/4/2016',0.00);
INSERT INTO FACTURA VALUES (1031,138,'2/5/2019',0.00);
INSERT INTO FACTURA VALUES (1032,160,'2/5/2019',0.00);
INSERT INTO FACTURA VALUES (1033,179,'4/5/2019',0.00);
INSERT INTO FACTURA VALUES (1034,194,'5/5/2019',0.00);
INSERT INTO FACTURA VALUES (1035,207,'6/5/2019',0.00);
INSERT INTO FACTURA VALUES (1036,219,'7/5/2019',0.00);
INSERT INTO FACTURA VALUES (1037,230,'8/5/2019',0.00);
INSERT INTO FACTURA VALUES (1038,239,'9/5/2019',0.00);
INSERT INTO FACTURA VALUES (1039,248,'10/5/2019',0.00);
INSERT INTO FACTURA VALUES (1040,256,'11/6/2019',0.00);
INSERT INTO FACTURA VALUES (1041,263,'12/6/19',0.00);
INSERT INTO FACTURA VALUES (1042,270,'13/6/2019',0.00);
INSERT INTO FACTURA VALUES (1043,277,'14/6/2019',0.00);
INSERT INTO FACTURA VALUES (1044,283,'15/6/2019',0.00);
INSERT INTO FACTURA VALUES (1045,289,'1/6/2019',0.00);
INSERT INTO FACTURA VALUES (1046,294,'2/6/2019',0.00);
INSERT INTO FACTURA VALUES (1047,299,'3/6/2019',0.00);
INSERT INTO FACTURA VALUES (1048,69,'4/7/2019',0.00);
INSERT INTO FACTURA VALUES (1049,160,'5/8/2019',0.00);
INSERT INTO FACTURA VALUES (1050,179,'6/9/2019',0.00);
COMMIT;


Begin transaction
INSERT INTO FACTURA VALUES (1051,69,'2/2/2020',0.00);
INSERT INTO FACTURA VALUES (1052,109,'2/2/2020',0.00);
INSERT INTO FACTURA VALUES (1053,138,'4/2/2020',0.00);
INSERT INTO FACTURA VALUES (1054,160,'4/2/2020',0.00);
INSERT INTO FACTURA VALUES (1055,179,'6/2/2020',0.00);
INSERT INTO FACTURA VALUES (1056,194,'6/2/2020',0.00);
INSERT INTO FACTURA VALUES (1057,207,'8/2/2020',0.00);
INSERT INTO FACTURA VALUES (1058,219,'8/2/2020',0.00);
INSERT INTO FACTURA VALUES (1059,230,'10/2/2020',0.00);
INSERT INTO FACTURA VALUES (1060,239,'10/2/2020',0.00);
INSERT INTO FACTURA VALUES (1061,248,'12/3/2020',0.00);
INSERT INTO FACTURA VALUES (1062,256,'12/3/2020',0.00);
INSERT INTO FACTURA VALUES (1063,263,'14/3/2020',0.00);
INSERT INTO FACTURA VALUES (1064,109,'14/3/2020',0.00);
INSERT INTO FACTURA VALUES (1065,277,'15/3/2020',0.00);
INSERT INTO FACTURA VALUES (1066,283,'15/3/2020',0.00);
INSERT INTO FACTURA VALUES (1067,109,'17/3/2020',0.00);
INSERT INTO FACTURA VALUES (1068,294,'17/3/2020',0.00);
INSERT INTO FACTURA VALUES (1069,299,'19/3/2020',0.00);
INSERT INTO FACTURA VALUES (1070,69,'19/3/2020',0.00);
INSERT INTO FACTURA VALUES (1071,109,'7/4/2020',0.00);
INSERT INTO FACTURA VALUES (1072,160,'7/4/2020',0.00);
INSERT INTO FACTURA VALUES (1073,256,'9/4/2020',0.00);
INSERT INTO FACTURA VALUES (1074,239,'9/4/2020',0.00);
INSERT INTO FACTURA VALUES (1075,138,'11/4/2020',0.00);
INSERT INTO FACTURA VALUES (1076,239,'11/4/2020',0.00);
INSERT INTO FACTURA VALUES (1077,138,'13/4/2020',0.00);
INSERT INTO FACTURA VALUES (1078,160,'13/4/2020',0.00);
INSERT INTO FACTURA VALUES (1079,230,'15/4/2020',0.00);
INSERT INTO FACTURA VALUES (1080,109,'15/4/2020',0.00);
INSERT INTO FACTURA VALUES (1081,138,'2/5/2020',0.00);
INSERT INTO FACTURA VALUES (1082,160,'2/5/2020',0.00);
INSERT INTO FACTURA VALUES (1083,179,'4/5/2020',0.00);
INSERT INTO FACTURA VALUES (1084,194,'5/5/2020',0.00);
INSERT INTO FACTURA VALUES (1085,207,'6/5/2020',0.00);
INSERT INTO FACTURA VALUES (1086,219,'7/5/2020',0.00);
INSERT INTO FACTURA VALUES (1087,230,'8/5/2020',0.00);
INSERT INTO FACTURA VALUES (1088,239,'9/5/2020',0.00);
INSERT INTO FACTURA VALUES (1089,248,'10/5/2020',0.00);
INSERT INTO FACTURA VALUES (1090,256,'11/6/2020',0.00);
INSERT INTO FACTURA VALUES (1091,263,'12/6/2020',0.00);
INSERT INTO FACTURA VALUES (1092,270,'13/6/2020',0.00);
INSERT INTO FACTURA VALUES (1093,277,'14/6/2020',0.00);
INSERT INTO FACTURA VALUES (1094,283,'15/6/2020',0.00);
INSERT INTO FACTURA VALUES (1095,289,'1/6/2020',0.00);
INSERT INTO FACTURA VALUES (1096,294,'2/6/2020',0.00);
INSERT INTO FACTURA VALUES (1097,299,'3/6/2020',0.00);
INSERT INTO FACTURA VALUES (1098,69,'4/7/2020',0.00);
INSERT INTO FACTURA VALUES (1099,160,'5/8/2020',0.00);
INSERT INTO FACTURA VALUES (1100,179,'6/9/2020',0.00);

-- Insertar factura a consumidor final
INSERT INTO FACTURA (nrofactura, fecha, total) VALUES (1101,'6/9/2020',0.00);

INSERT INTO  DETALLE  Values  (1101, 1, 4070, 2, 5.00);
COMMIT;





BEGIN TRANSACTION;
INSERT INTO DETALLE VALUES(1001,1,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1002,1,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1003,1,4080,1.00,0.00);
INSERT INTO DETALLE VALUES(1003,2,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1004,1,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1004,2,4100,2.00,0.00);
INSERT INTO DETALLE VALUES(1004,3,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1005,1,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1005,2,4110,3.00,0.00);
INSERT INTO DETALLE VALUES(1005,3,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1005,4,4010,1.00,0.00);
INSERT INTO DETALLE VALUES(1005,5,4020,2.00,0.00);
INSERT INTO DETALLE VALUES(1005,6,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1005,7,4040,1.00,0.00);
INSERT INTO DETALLE VALUES(1005,8,4050,1.00,0.00);
INSERT INTO DETALLE VALUES(1005,9,4060,5.00,0.00);
INSERT INTO DETALLE VALUES(1005,10,4070,3.00,0.00);
INSERT INTO DETALLE VALUES(1006,1,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1007,1,4000,2.00,0.00);
INSERT INTO DETALLE VALUES(1008,1,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1008,2,4020,3.00,0.00);
INSERT INTO DETALLE VALUES(1009,1,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1010,1,4030,2.00,0.00);
INSERT INTO DETALLE VALUES(1010,2,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1011,1,4040,5.00,0.00);
INSERT INTO DETALLE VALUES(1012,1,4050,2.00,0.00);
INSERT INTO DETALLE VALUES(1012,2,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1013,1,4060,1.00,0.00);
INSERT INTO DETALLE VALUES(1014,1,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1014,2,4080,3.00,0.00);
INSERT INTO DETALLE VALUES(1014,3,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1014,4,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1014,5,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1014,6,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1015,1,4080,2.00,0.00);
INSERT INTO DETALLE VALUES(1015,2,4090,6.00,0.00);
INSERT INTO DETALLE VALUES(1016,1,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1016,2,4100,6.00,0.00);
INSERT INTO DETALLE VALUES(1016,3,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1017,1,4100,5.00,0.00);
INSERT INTO DETALLE VALUES(1017,2,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1018,1,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1018,2,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1018,3,4010,4.00,0.00);
INSERT INTO DETALLE VALUES(1018,4,4020,2.00,0.00);
INSERT INTO DETALLE VALUES(1018,5,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1018,6,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1018,7,4050,3.00,0.00);
INSERT INTO DETALLE VALUES(1018,8,4060,5.00,0.00);
INSERT INTO DETALLE VALUES(1018,9,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1019,1,4000,3.00,0.00);
INSERT INTO DETALLE VALUES(1019,2,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1019,3,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1019,4,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1020,1,4010,2.00,0.00);
INSERT INTO DETALLE VALUES(1021,1,4020,4.00,0.00);
INSERT INTO DETALLE VALUES(1021,2,4030,4.00,0.00);
INSERT INTO DETALLE VALUES(1021,3,4040,2.00,0.00);
INSERT INTO DETALLE VALUES(1021,4,4050,6.00,0.00);
INSERT INTO DETALLE VALUES(1021,5,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1022,1,4030,3.00,0.00);
INSERT INTO DETALLE VALUES(1022,2,4040,2.00,0.00);
INSERT INTO DETALLE VALUES(1023,1,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1023,2,4050,6.00,0.00);
INSERT INTO DETALLE VALUES(1023,3,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1023,4,4070,2.00,0.00);
INSERT INTO DETALLE VALUES(1023,5,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1024,1,4050,3.00,0.00);
INSERT INTO DETALLE VALUES(1024,2,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1024,3,4070,6.00,0.00);
INSERT INTO DETALLE VALUES(1025,1,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1025,2,4070,1.00,0.00);
INSERT INTO DETALLE VALUES(1025,3,4080,1.00,0.00);
INSERT INTO DETALLE VALUES(1026,1,4070,6.00,0.00);
INSERT INTO DETALLE VALUES(1026,2,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1027,1,4080,3.00,0.00);
INSERT INTO DETALLE VALUES(1027,2,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1028,1,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1028,2,4100,2.00,0.00);
INSERT INTO DETALLE VALUES(1028,3,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1029,1,4100,1.00,0.00);
INSERT INTO DETALLE VALUES(1029,2,4110,3.00,0.00);
INSERT INTO DETALLE VALUES(1030,1,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1030,2,4000,4.00,0.00);
INSERT INTO DETALLE VALUES(1030,3,4010,2.00,0.00);
INSERT INTO DETALLE VALUES(1030,4,4020,3.00,0.00);
INSERT INTO DETALLE VALUES(1031,1,4000,2.00,0.00);
INSERT INTO DETALLE VALUES(1031,2,4010,3.00,0.00);
INSERT INTO DETALLE VALUES(1032,1,4010,3.00,0.00);
INSERT INTO DETALLE VALUES(1032,2,4020,2.00,0.00);
INSERT INTO DETALLE VALUES(1032,3,4030,3.00,0.00);
INSERT INTO DETALLE VALUES(1032,4,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1032,5,4050,5.00,0.00);
INSERT INTO DETALLE VALUES(1032,6,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1033,1,4020,6.00,0.00);
INSERT INTO DETALLE VALUES(1033,2,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1033,3,4040,6.00,0.00);
INSERT INTO DETALLE VALUES(1033,4,4050,3.00,0.00);
INSERT INTO DETALLE VALUES(1033,5,4060,2.00,0.00);
INSERT INTO DETALLE VALUES(1033,6,4070,1.00,0.00);
INSERT INTO DETALLE VALUES(1033,7,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1033,8,4090,6.00,0.00);
INSERT INTO DETALLE VALUES(1034,1,4030,1.00,0.00);
INSERT INTO DETALLE VALUES(1035,1,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1035,2,4050,5.00,0.00);
INSERT INTO DETALLE VALUES(1036,1,4050,2.00,0.00);
INSERT INTO DETALLE VALUES(1037,1,4060,1.00,0.00);
INSERT INTO DETALLE VALUES(1037,2,4070,1.00,0.00);
INSERT INTO DETALLE VALUES(1037,3,4080,2.00,0.00);
INSERT INTO DETALLE VALUES(1037,4,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1037,5,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1037,6,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1037,7,4000,3.00,0.00);
INSERT INTO DETALLE VALUES(1037,8,4010,5.00,0.00);
INSERT INTO DETALLE VALUES(1038,1,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1038,2,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1038,3,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1038,4,4100,5.00,0.00);
INSERT INTO DETALLE VALUES(1038,5,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1038,6,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1038,7,4010,2.00,0.00);
INSERT INTO DETALLE VALUES(1039,1,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1039,2,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1039,3,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1039,4,4110,1.00,0.00);
INSERT INTO DETALLE VALUES(1039,5,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1040,1,4090,5.00,0.00);
INSERT INTO DETALLE VALUES(1040,2,4100,1.00,0.00);
INSERT INTO DETALLE VALUES(1040,3,4110,6.00,0.00);
INSERT INTO DETALLE VALUES(1040,4,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1040,5,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1040,6,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1040,7,4030,1.00,0.00);
INSERT INTO DETALLE VALUES(1040,8,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1041,1,4100,6.00,0.00);
INSERT INTO DETALLE VALUES(1041,2,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1041,3,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1041,4,4010,1.00,0.00);
INSERT INTO DETALLE VALUES(1041,5,4020,5.00,0.00);
INSERT INTO DETALLE VALUES(1041,6,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1041,7,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1041,8,4050,1.00,0.00);
INSERT INTO DETALLE VALUES(1042,1,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1042,2,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1042,3,4010,3.00,0.00);
INSERT INTO DETALLE VALUES(1042,4,4020,6.00,0.00);
INSERT INTO DETALLE VALUES(1042,5,4030,3.00,0.00);
INSERT INTO DETALLE VALUES(1043,1,4000,4.00,0.00);
INSERT INTO DETALLE VALUES(1043,2,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1043,3,4020,5.00,0.00);
INSERT INTO DETALLE VALUES(1043,4,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1044,1,4010,5.00,0.00);
INSERT INTO DETALLE VALUES(1044,2,4020,5.00,0.00);
INSERT INTO DETALLE VALUES(1044,3,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1044,4,4040,1.00,0.00);
INSERT INTO DETALLE VALUES(1044,5,4050,1.00,0.00);
INSERT INTO DETALLE VALUES(1044,6,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1045,1,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1045,2,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1045,3,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1045,4,4050,2.00,0.00);
INSERT INTO DETALLE VALUES(1046,1,4030,1.00,0.00);
INSERT INTO DETALLE VALUES(1046,2,4040,1.00,0.00);
INSERT INTO DETALLE VALUES(1047,1,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1048,1,4050,5.00,1.00);
INSERT INTO DETALLE VALUES(1048,2,4060,6.00,2.00);
INSERT INTO DETALLE VALUES(1048,3,4070,4.00,3.00);
INSERT INTO DETALLE VALUES(1048,4,4080,2.00,4.00);
INSERT INTO DETALLE VALUES(1048,5,4090,5.00,5.00);
INSERT INTO DETALLE VALUES(1048,6,4100,2.00,6.00);
INSERT INTO DETALLE VALUES(1048,7,4110,6.00,7.00);
INSERT INTO DETALLE VALUES(1048,8,4000,5.00,8.00);
INSERT INTO DETALLE VALUES(1048,9,4010,3.00,9.00);
INSERT INTO DETALLE VALUES(1048,10,4020,5.00,10.00);
INSERT INTO DETALLE VALUES(1048,11,4030,4.00,11.00);
INSERT INTO DETALLE VALUES(1048,12,4040,2.00,12.00);
INSERT INTO DETALLE VALUES(1049,1,4060,2.00,13.00);
INSERT INTO DETALLE VALUES(1049,2,4070,3.00,14.00);
INSERT INTO DETALLE VALUES(1049,3,4080,5.00,15.00);
INSERT INTO DETALLE VALUES(1049,4,4090,6.00,16.00);
INSERT INTO DETALLE VALUES(1049,5,4100,2.00,17.00);
INSERT INTO DETALLE VALUES(1050,1,4070,5.00,18.00);
INSERT INTO DETALLE VALUES(1050,2,4080,6.00,19.00);
INSERT INTO DETALLE VALUES(1050,3,4090,6.00,20.00);
COMMIT;




BEGIN TRANSACTION;
INSERT INTO DETALLE VALUES(1051,1,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1052,1,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1053,1,4080,1.00,0.00);
INSERT INTO DETALLE VALUES(1053,2,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1054,1,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1054,2,4100,2.00,0.00);
INSERT INTO DETALLE VALUES(1054,3,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1055,1,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1055,2,4110,3.00,0.00);
INSERT INTO DETALLE VALUES(1055,3,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1055,4,4010,1.00,0.00);
INSERT INTO DETALLE VALUES(1055,5,4020,2.00,0.00);
INSERT INTO DETALLE VALUES(1055,6,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1055,7,4040,1.00,0.00);
INSERT INTO DETALLE VALUES(1055,8,4050,1.00,0.00);
INSERT INTO DETALLE VALUES(1055,9,4060,5.00,0.00);
INSERT INTO DETALLE VALUES(1055,10,4070,3.00,0.00);
INSERT INTO DETALLE VALUES(1056,1,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1057,1,4000,2.00,0.00);
INSERT INTO DETALLE VALUES(1058,1,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1058,2,4020,3.00,0.00);
INSERT INTO DETALLE VALUES(1059,1,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1060,1,4030,2.00,0.00);
INSERT INTO DETALLE VALUES(1060,2,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1061,1,4040,5.00,0.00);
INSERT INTO DETALLE VALUES(1062,1,4050,2.00,0.00);
INSERT INTO DETALLE VALUES(1062,2,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1063,1,4060,1.00,0.00);
INSERT INTO DETALLE VALUES(1064,1,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1064,2,4080,3.00,0.00);
INSERT INTO DETALLE VALUES(1064,3,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1064,4,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1064,5,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1064,6,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1065,1,4080,2.00,0.00);
INSERT INTO DETALLE VALUES(1065,2,4090,6.00,0.00);
INSERT INTO DETALLE VALUES(1066,1,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1066,2,4100,6.00,0.00);
INSERT INTO DETALLE VALUES(1066,3,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1067,1,4100,5.00,0.00);
INSERT INTO DETALLE VALUES(1067,2,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1068,1,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1068,2,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1068,3,4010,4.00,0.00);
INSERT INTO DETALLE VALUES(1068,4,4020,2.00,0.00);
INSERT INTO DETALLE VALUES(1068,5,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1068,6,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1068,7,4050,3.00,0.00);
INSERT INTO DETALLE VALUES(1068,8,4060,5.00,0.00);
INSERT INTO DETALLE VALUES(1068,9,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1069,1,4000,3.00,0.00);
INSERT INTO DETALLE VALUES(1069,2,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1069,3,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1069,4,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1070,1,4010,2.00,0.00);
INSERT INTO DETALLE VALUES(1071,1,4020,4.00,0.00);
INSERT INTO DETALLE VALUES(1071,2,4030,4.00,0.00);
INSERT INTO DETALLE VALUES(1071,3,4040,2.00,0.00);
INSERT INTO DETALLE VALUES(1071,4,4050,6.00,0.00);
INSERT INTO DETALLE VALUES(1071,5,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1072,1,4030,3.00,0.00);
INSERT INTO DETALLE VALUES(1072,2,4040,2.00,0.00);
INSERT INTO DETALLE VALUES(1073,1,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1073,2,4050,6.00,0.00);
INSERT INTO DETALLE VALUES(1073,3,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1073,4,4070,2.00,0.00);
INSERT INTO DETALLE VALUES(1073,5,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1074,1,4050,3.00,0.00);
INSERT INTO DETALLE VALUES(1074,2,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1074,3,4070,6.00,0.00);
INSERT INTO DETALLE VALUES(1075,1,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1075,2,4070,1.00,0.00);
INSERT INTO DETALLE VALUES(1075,3,4080,1.00,0.00);
INSERT INTO DETALLE VALUES(1076,1,4070,6.00,0.00);
INSERT INTO DETALLE VALUES(1076,2,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1077,1,4080,3.00,0.00);
INSERT INTO DETALLE VALUES(1077,2,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1078,1,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1078,2,4100,2.00,0.00);
INSERT INTO DETALLE VALUES(1078,3,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1079,1,4100,1.00,0.00);
INSERT INTO DETALLE VALUES(1079,2,4110,3.00,0.00);
INSERT INTO DETALLE VALUES(1080,1,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1080,2,4000,4.00,0.00);
INSERT INTO DETALLE VALUES(1080,3,4010,2.00,0.00);
INSERT INTO DETALLE VALUES(1080,4,4020,3.00,0.00);
INSERT INTO DETALLE VALUES(1081,1,4000,2.00,0.00);
INSERT INTO DETALLE VALUES(1081,2,4010,3.00,0.00);
INSERT INTO DETALLE VALUES(1082,1,4010,3.00,0.00);
INSERT INTO DETALLE VALUES(1082,2,4020,2.00,0.00);
INSERT INTO DETALLE VALUES(1082,3,4030,3.00,0.00);
INSERT INTO DETALLE VALUES(1082,4,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1082,5,4050,5.00,0.00);
INSERT INTO DETALLE VALUES(1082,6,4060,6.00,0.00);
INSERT INTO DETALLE VALUES(1083,1,4020,6.00,0.00);
INSERT INTO DETALLE VALUES(1083,2,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1083,3,4040,6.00,0.00);
INSERT INTO DETALLE VALUES(1083,4,4050,3.00,0.00);
INSERT INTO DETALLE VALUES(1083,5,4060,2.00,0.00);
INSERT INTO DETALLE VALUES(1083,6,4070,1.00,0.00);
INSERT INTO DETALLE VALUES(1083,7,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1083,8,4090,6.00,0.00);
INSERT INTO DETALLE VALUES(1084,1,4030,1.00,0.00);
INSERT INTO DETALLE VALUES(1085,1,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1085,2,4050,5.00,0.00);
INSERT INTO DETALLE VALUES(1086,1,4050,2.00,0.00);
INSERT INTO DETALLE VALUES(1087,1,4060,1.00,0.00);
INSERT INTO DETALLE VALUES(1087,2,4070,1.00,0.00);
INSERT INTO DETALLE VALUES(1087,3,4080,2.00,0.00);
INSERT INTO DETALLE VALUES(1087,4,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1087,5,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1087,6,4110,4.00,0.00);
INSERT INTO DETALLE VALUES(1087,7,4000,3.00,0.00);
INSERT INTO DETALLE VALUES(1087,8,4010,5.00,0.00);
INSERT INTO DETALLE VALUES(1088,1,4070,5.00,0.00);
INSERT INTO DETALLE VALUES(1088,2,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1088,3,4090,2.00,0.00);
INSERT INTO DETALLE VALUES(1088,4,4100,5.00,0.00);
INSERT INTO DETALLE VALUES(1088,5,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1088,6,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1088,7,4010,2.00,0.00);
INSERT INTO DETALLE VALUES(1089,1,4080,5.00,0.00);
INSERT INTO DETALLE VALUES(1089,2,4090,3.00,0.00);
INSERT INTO DETALLE VALUES(1089,3,4100,3.00,0.00);
INSERT INTO DETALLE VALUES(1089,4,4110,1.00,0.00);
INSERT INTO DETALLE VALUES(1089,5,4000,1.00,0.00);
INSERT INTO DETALLE VALUES(1090,1,4090,5.00,0.00);
INSERT INTO DETALLE VALUES(1090,2,4100,1.00,0.00);
INSERT INTO DETALLE VALUES(1090,3,4110,6.00,0.00);
INSERT INTO DETALLE VALUES(1090,4,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1090,5,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1090,6,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1090,7,4030,1.00,0.00);
INSERT INTO DETALLE VALUES(1090,8,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1091,1,4100,6.00,0.00);
INSERT INTO DETALLE VALUES(1091,2,4110,5.00,0.00);
INSERT INTO DETALLE VALUES(1091,3,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1091,4,4010,1.00,0.00);
INSERT INTO DETALLE VALUES(1091,5,4020,5.00,0.00);
INSERT INTO DETALLE VALUES(1091,6,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1091,7,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1091,8,4050,1.00,0.00);
INSERT INTO DETALLE VALUES(1092,1,4110,2.00,0.00);
INSERT INTO DETALLE VALUES(1092,2,4000,6.00,0.00);
INSERT INTO DETALLE VALUES(1092,3,4010,3.00,0.00);
INSERT INTO DETALLE VALUES(1092,4,4020,6.00,0.00);
INSERT INTO DETALLE VALUES(1092,5,4030,3.00,0.00);
INSERT INTO DETALLE VALUES(1093,1,4000,4.00,0.00);
INSERT INTO DETALLE VALUES(1093,2,4010,6.00,0.00);
INSERT INTO DETALLE VALUES(1093,3,4020,5.00,0.00);
INSERT INTO DETALLE VALUES(1093,4,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1094,1,4010,5.00,0.00);
INSERT INTO DETALLE VALUES(1094,2,4020,5.00,0.00);
INSERT INTO DETALLE VALUES(1094,3,4030,5.00,0.00);
INSERT INTO DETALLE VALUES(1094,4,4040,1.00,0.00);
INSERT INTO DETALLE VALUES(1094,5,4050,1.00,0.00);
INSERT INTO DETALLE VALUES(1094,6,4060,3.00,0.00);
INSERT INTO DETALLE VALUES(1095,1,4020,1.00,0.00);
INSERT INTO DETALLE VALUES(1095,2,4030,6.00,0.00);
INSERT INTO DETALLE VALUES(1095,3,4040,3.00,0.00);
INSERT INTO DETALLE VALUES(1095,4,4050,2.00,0.00);
INSERT INTO DETALLE VALUES(1096,1,4030,1.00,0.00);
INSERT INTO DETALLE VALUES(1096,2,4040,1.00,0.00);
INSERT INTO DETALLE VALUES(1097,1,4040,4.00,0.00);
INSERT INTO DETALLE VALUES(1098,1,4050,5.00,1.00);
INSERT INTO DETALLE VALUES(1098,2,4060,6.00,2.00);
INSERT INTO DETALLE VALUES(1098,3,4070,4.00,3.00);
INSERT INTO DETALLE VALUES(1098,4,4080,2.00,4.00);
INSERT INTO DETALLE VALUES(1098,5,4090,5.00,5.00);
INSERT INTO DETALLE VALUES(1098,6,4100,2.00,6.00);
INSERT INTO DETALLE VALUES(1098,7,4110,6.00,7.00);
INSERT INTO DETALLE VALUES(1098,8,4000,5.00,8.00);
INSERT INTO DETALLE VALUES(1098,9,4010,3.00,9.00);
INSERT INTO DETALLE VALUES(1098,10,4020,5.00,10.00);
INSERT INTO DETALLE VALUES(1098,11,4030,4.00,11.00);
INSERT INTO DETALLE VALUES(1098,12,4040,2.00,12.00);
INSERT INTO DETALLE VALUES(1099,1,4060,2.00,13.00);
INSERT INTO DETALLE VALUES(1099,2,4070,3.00,14.00);
INSERT INTO DETALLE VALUES(1099,3,4080,5.00,15.00);
INSERT INTO DETALLE VALUES(1099,4,4090,6.00,16.00);
INSERT INTO DETALLE VALUES(1099,5,4100,2.00,17.00);
INSERT INTO DETALLE VALUES(1100,1,4070,5.00,18.00);
INSERT INTO DETALLE VALUES(1100,2,4080,6.00,19.00);
INSERT INTO DETALLE VALUES(1100,3,4090,6.00,20.00);
INSERT INTO DETALLE VALUES(1100,4,4120,6.00,25000.00);

COMMIT;



UPDATE DETALLE SET PRECIOUNI = (SELECT PRECIO FROM ARTICULO
                              WHERE DETALLE.ARTICULO = ARTICULO.NROARTIC);


UPDATE FACTURA SET TOTAL = (SELECT SUM(PRECIOUNI * CANTIDAD) FROM DETALLE
                              WHERE FACTURA.NROFACTURA = DETALLE.NROFACTURA);



UPDATE FACTURA  SET FECHA =  DATEADD (YEAR, 4, FECHA);

--
-- INSERT INTO de Datos con NULL
--
BEGIN TRANSACTION;
INSERT INTO CLIENTE (nrocli, nyape, saldocli) VALUES (502,'Jose Pereira',-2778.00);
INSERT INTO CLIENTE (nrocli, nyape, saldocli) VALUES (509,'Pablo Ferro',3880.00);
INSERT INTO CLIENTE (nrocli, nyape, domicilio, saldocli) VALUES (520,'Pablo Ferro','Peru 31',23728.00);
COMMIT;


